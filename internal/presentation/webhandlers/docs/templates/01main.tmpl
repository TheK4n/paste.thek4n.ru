{{template "base" .}}

{{define "main"}}

{{range .Sections}}
<h2>{{.Name}}</h2>
<p>{{.Description}}</p>

{{range .Endpoints}}
<div class="endpoint">
    <div>
        <span class="method {{.Method}}">{{.Method}}</span>
        <span class="path">{{.Path}}</span>
    </div>
    <p>{{.Description}}</p>

    <div class="tab">
        <button class="tablinks" onclick="openTab(event, 'docs-{{.ID}}')">Description</button>
        <button class="tablinks" onclick="openTab(event, 'try-{{.ID}}')">Try</button>
    </div>

    <div id="docs-{{.ID}}" class="tabcontent" style="display: none;">
        {{if .Parameters}}
        <h3>Parameters</h3>
        <table class="param-table">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Place</th>
                    <th>Required</th>
                    <th>Description</th>
                    <th>Default</th>
                </tr>
            </thead>
            <tbody>
                {{range .Parameters}}
                <tr>
                    <td><code>{{.Name}}</code></td>
                    <td>{{.Type}}</td>
                    <td>{{.In}}</td>
                    <td>{{if .Required}}Yes{{else}}No{{end}}</td>
                    <td>{{.Description}}</td>
                    <td>{{.Default}}</td>
                </tr>
                {{end}}
            </tbody>
        </table>
        {{end}}

        {{if .RequestExample}}
        <h3>Request example</h3>
        <pre><code>{{.RequestExample}}</code></pre>
        {{end}}

        {{if .ResponseExample}}
        <h3>Response example</h3>
        <pre><code>{{.ResponseExample}}</code></pre>
        {{end}}
    </div>

    <div id="try-{{.ID}}" class="tabcontent">
        {{if .Parameters}}
        <h3>Parameters</h3>
        <div id="params-{{.ID}}">
            {{range .Parameters}}
            <div class="param-input">
                <label for="{{.Name}}">{{.Name}} ({{.In}}):</label>
                {{if eq .Type "boolean"}}
                <select id="{{.Name}}">
                    <option value="true" {{if eq .Default "true"}}selected{{end}}>true</option>
                    <option value="false" {{if eq .Default "false"}}selected{{end}}>false</option>
                </select>
                {{else if eq .Type "integer"}}
                <input type="number" id="{{.Name}}" value="{{.Default}}" step="1">
                {{else if eq .Type "number"}}
                <input type="number" id="{{.Name}}" value="{{.Default}}">
                {{else if eq .In "body"}}
                <textarea id="{{.Name}}">{{.Default}}</textarea>
                {{else}}
                <input type="text" id="{{.Name}}" value="{{.Default}}">
                {{end}}
            </div>
            {{end}}
        </div>
        {{end}}

        <button class="try-it" onclick="tryEndpoint('{{$.BaseURL}}', '{{.Method}}', '{{.Path}}', '{{.ID}}')">Try-it</button>
        <div class="response-area" id="response-{{.ID}}">
            <p>Press "Try-it" to see result</p>
        </div>
    </div>
</div>
{{end}}
{{end}}

{{end}}
